<!DOCTYPE html>
<html>
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="一、请求中的数据请求中的数据都需要以来flask.request对象，因此在获取请求中的数据时，需要通过from flask import request来引入请求对象，并且需要知道的时，flask.request是做了线程隔离的。 1.GETGET请求会将参数以urlencode编码的形式放到URL的最后面，如:http://host?k1=v1&amp;amp;k2=v2。在Flask通过flask.">
<meta property="og:type" content="article">
<meta property="og:title" content="Flask Basic">
<meta property="og:url" content="http://github.com/lsj9383/2019/02/06/Flask-Basic/index.html">
<meta property="og:site_name" content="小记">
<meta property="og:description" content="一、请求中的数据请求中的数据都需要以来flask.request对象，因此在获取请求中的数据时，需要通过from flask import request来引入请求对象，并且需要知道的时，flask.request是做了线程隔离的。 1.GETGET请求会将参数以urlencode编码的形式放到URL的最后面，如:http://host?k1=v1&amp;amp;k2=v2。在Flask通过flask.">
<meta property="og:updated_time" content="2019-02-06T06:08:08.541Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Flask Basic">
<meta name="twitter:description" content="一、请求中的数据请求中的数据都需要以来flask.request对象，因此在获取请求中的数据时，需要通过from flask import request来引入请求对象，并且需要知道的时，flask.request是做了线程隔离的。 1.GETGET请求会将参数以urlencode编码的形式放到URL的最后面，如:http://host?k1=v1&amp;amp;k2=v2。在Flask通过flask.">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Flask Basic</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    
    
</head>

<body>
    
      <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/lsj9383">GitHub</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/02/06/OAUTH-2-0/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/02/06/Start-Hexo/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://github.com/lsj9383/2019/02/06/Flask-Basic/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://github.com/lsj9383/2019/02/06/Flask-Basic/&text=Flask Basic"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://github.com/lsj9383/2019/02/06/Flask-Basic/&title=Flask Basic"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://github.com/lsj9383/2019/02/06/Flask-Basic/&is_video=false&description=Flask Basic"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Flask Basic&body=Check out this article: http://github.com/lsj9383/2019/02/06/Flask-Basic/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://github.com/lsj9383/2019/02/06/Flask-Basic/&title=Flask Basic"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://github.com/lsj9383/2019/02/06/Flask-Basic/&title=Flask Basic"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://github.com/lsj9383/2019/02/06/Flask-Basic/&title=Flask Basic"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://github.com/lsj9383/2019/02/06/Flask-Basic/&title=Flask Basic"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://github.com/lsj9383/2019/02/06/Flask-Basic/&name=Flask Basic&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、请求中的数据"><span class="toc-number">1.</span> <span class="toc-text">一、请求中的数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-GET"><span class="toc-number">1.1.</span> <span class="toc-text">1.GET</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-POST"><span class="toc-number">1.2.</span> <span class="toc-text">2.POST</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Cookie"><span class="toc-number">1.3.</span> <span class="toc-text">3.Cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Headers"><span class="toc-number">1.4.</span> <span class="toc-text">4.Headers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-File"><span class="toc-number">1.5.</span> <span class="toc-text">5.File</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-urlencode-urldecode"><span class="toc-number">1.6.</span> <span class="toc-text">6.urlencode/urldecode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-POST的中文处理"><span class="toc-number">1.7.</span> <span class="toc-text">7.POST的中文处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-Body中的数据"><span class="toc-number">1.8.</span> <span class="toc-text">7.Body中的数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、响应中的数据"><span class="toc-number">2.</span> <span class="toc-text">二、响应中的数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-字符串"><span class="toc-number">2.1.</span> <span class="toc-text">1.字符串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-JSON"><span class="toc-number">2.2.</span> <span class="toc-text">2.JSON</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Cookie-1"><span class="toc-number">2.3.</span> <span class="toc-text">3.Cookie</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、缓存中的数据"><span class="toc-number">3.</span> <span class="toc-text">三、缓存中的数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Session"><span class="toc-number">3.1.</span> <span class="toc-text">1.Session</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-SimpleCache"><span class="toc-number">3.2.</span> <span class="toc-text">2.SimpleCache</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#a-基本使用"><span class="toc-number">3.2.1.</span> <span class="toc-text">a) 基本使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#b-超时机制"><span class="toc-number">3.2.2.</span> <span class="toc-text">b) 超时机制</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Flask Basic
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">小记</span>
      </span>
      
    <div class="postdate">
        <time datetime="2019-02-06T06:08:00.000Z" itemprop="datePublished">2019-02-06</time>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="一、请求中的数据"><a href="#一、请求中的数据" class="headerlink" title="一、请求中的数据"></a>一、请求中的数据</h2><p>请求中的数据都需要以来flask.request对象，因此在获取请求中的数据时，需要通过<code>from flask import request</code>来引入请求对象，并且需要知道的时，flask.request是做了线程隔离的。</p>
<h3 id="1-GET"><a href="#1-GET" class="headerlink" title="1.GET"></a>1.<em>GET</em></h3><p>GET请求会将参数以urlencode编码的形式放到URL的最后面，如:<code>http://host?k1=v1&amp;k2=v2</code>。在Flask通过flask.request.args可以将GET的参数提取出来。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line">...</span><br><span class="line">request.args.get(<span class="string">"k1"</span>, d=<span class="keyword">None</span>)  // 获取k1对应的值,若k1不存在则返回默认值<span class="keyword">None</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<h3 id="2-POST"><a href="#2-POST" class="headerlink" title="2.POST"></a>2.<em>POST</em></h3><p>POST请求会将参数以urlencode编码的形式放到请求的请求体中。在Flask中通过flask.request.form来获取。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line">...</span><br><span class="line">request.form.get(<span class="string">"k1"</span>, <span class="keyword">None</span>)</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<h3 id="3-Cookie"><a href="#3-Cookie" class="headerlink" title="3.Cookie"></a>3.<em>Cookie</em></h3><p>客户端可以自行缓存一些数据，并在每次请求的时候将这些数据发送到服务器。通过将Cookie数据放入到请求行的<code>Cookie</code>请求行里，指定请求含Cookie。后台可以在不操作Headers的情况下，直接读取Cookie。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">form flask <span class="keyword">import</span> request</span><br><span class="line">...</span><br><span class="line">request.cookies.get(<span class="string">"k1"</span>, <span class="keyword">None</span>)</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<h3 id="4-Headers"><a href="#4-Headers" class="headerlink" title="4.Headers"></a>4.<em>Headers</em></h3><p>http请求中的请求行中的数据，可以通过<code>request.headers</code>进行获取。</p>
<h3 id="5-File"><a href="#5-File" class="headerlink" title="5.File"></a>5.<em>File</em></h3><p>http发送的文件，在Flask可以通过flask.request.files来获取，并且flask提供了一些相关的方法，方便进行相关的文件操作：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">from</span> werkzeug <span class="keyword">import</span> secure_filename</span><br><span class="line">...</span><br><span class="line">f = request.files.get(<span class="string">"name"</span>, <span class="keyword">None</span>)</span><br><span class="line">filename = secure_filename(f.filename)  <span class="comment"># 文件名，</span></span><br><span class="line">f.save(dir_path, f.filename)            <span class="comment"># 文件保存在本地</span></span><br><span class="line">f.save(filepath)                        <span class="comment"># 文件保存在本地</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<p><code>secure_filename()</code>函数可以用于确保上传文件名的安全性。如f.filename的文件名是<code>../../../../../../config</code>，并且我们采用该文件名拼接文件夹路径的形式保存文件，则可能会导致系统文件夹下的某个文件被覆盖。</p>
<h3 id="6-urlencode-urldecode"><a href="#6-urlencode-urldecode" class="headerlink" title="6.urlencode/urldecode"></a>6.<em>urlencode/urldecode</em></h3><p>在Web发送GET或者POST请求时，会对参数进行编码，例如urlencode和json，具体采用的编码模式，由Headers中的<code>content-type</code>指出<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">content-type:&apos;application/x-www-form-urlencoded&apos;    # 默认</span><br><span class="line">content-type:&apos;application/json&apos;                     # json</span><br></pre></td></tr></table></figure></p>
<p>服务器在接收到请求后，会通过urldecode来将kv值重新结构话，并放在request.args或者request.form中。当服务器接收到的请求是以其他方式进行编码的(如JSON)，Flask无法将其urldecode，造成无法解析，这时Flask将会把请求体中的二进制数据放到request.data中。</p>
<h3 id="7-POST的中文处理"><a href="#7-POST的中文处理" class="headerlink" title="7.POST的中文处理"></a>7.POST的中文处理</h3><p>在发送POST请求时，除了涉及到urlencode外，还会对中文进行NCR(数字字符引用)，意思就是取中文的Unicode数值代替中文本身。</p>
<ul>
<li>#&amp;, 代表数字采用十进制表示，POST所采用的。</li>
<li>&amp;#x, 代表数字采用十六进制表示。</li>
</ul>
<p>例如<code>好</code>对应的Unicode标识是<code>22909</code>，再POST传输<code>好</code>时，将会用<code>&amp;#22909</code>来代替好。</p>
<p>在Flask中，需要对POST的中文数据进行反义处理，才能在Python中获得正确的中文字符串:<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">unescape</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">from</span> html.parser <span class="keyword">import</span> HTMLParser</span><br><span class="line">    <span class="keyword">return</span> HTMLParser().unescape(s) <span class="keyword">if</span> s!=<span class="keyword">None</span> <span class="keyword">else</span> <span class="keyword">None</span></span><br><span class="line">    </span><br><span class="line">print(unescape(<span class="string">"&amp;#22909"</span>))      <span class="comment"># 输出"好"</span></span><br></pre></td></tr></table></figure></p>
<h3 id="7-Body中的数据"><a href="#7-Body中的数据" class="headerlink" title="7.Body中的数据"></a>7.<em>Body中的数据</em></h3><p>上面取body中的数据方式基本上都有对body进行了解析，如果希望取出最完整的、最原始的来自request中的body数据，可以通过<code>get_data()</code>接口:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">form flask <span class="keyword">import</span> request</span><br><span class="line">...</span><br><span class="line">request.get_data()</span><br><span class="line">...</span><br></pre></td></tr></table></figure></p>
<h2 id="二、响应中的数据"><a href="#二、响应中的数据" class="headerlink" title="二、响应中的数据"></a>二、响应中的数据</h2><h3 id="1-字符串"><a href="#1-字符串" class="headerlink" title="1.字符串"></a>1.<em>字符串</em></h3><p>在视图函数中直接返回字符串，则响应体就是该字符串。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route("/view")</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">view</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">"hello world"</span></span><br></pre></td></tr></table></figure></p>
<h3 id="2-JSON"><a href="#2-JSON" class="headerlink" title="2.JSON"></a>2.<em>JSON</em></h3><p>在Flask可以采用两种方式返回JSON数据：</p>
<ul>
<li>a) Python的JSON库<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Response</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="meta">@app.route("/view")</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">view</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> Response(json.dumps(&#123;...&#125;), mimetype=<span class="string">'application/json'</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>通过构造Response对象，并指明mimetype为<code>application/json</code>，这样可以设置<code>Content-Type</code>为<code>application/json</code>，指出返回体的数据为JSON。</p>
<ul>
<li>b) Flask的jsonify<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> jsonify</span><br><span class="line"><span class="meta">@app.route("/view")</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">view</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;...&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>jsonify已经默认设置了<code>Content-Type</code>为<code>application/json</code>，无需重复设置。另外jsonify的返回体经过了格式化，使得起其JSON更易读。</p>
<p>需要注意的是，不管是Python的JSON库还是Flask的jsonify，都会将中文字符进行Unicode编码，再将编码数值的十六进制进行字符化，并在前面加<code>\u</code>来指出这是一个Unicode字符。如<code>{&quot;hello&quot;:&quot;你好&quot;}</code> —&gt; <code>{&quot;hello&quot;:&quot;\u4f60\u597d&quot;}</code></p>
<h3 id="3-Cookie-1"><a href="#3-Cookie-1" class="headerlink" title="3.Cookie"></a>3.<em>Cookie</em></h3><p>服务器可以通过请求头中的<code>Set-Cookei</code>指出让浏览器缓存的一些数据，在Flask中可以通过构造Response对象来设置需要浏览器缓存的cookie。<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Response</span><br><span class="line"><span class="meta">@app.route("/view")</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">view</span><span class="params">()</span>:</span></span><br><span class="line">    r = Response(&lt;response-body&gt;)</span><br><span class="line">    r.set_cookie(<span class="string">'key'</span>,<span class="string">'val'</span>, [expires=])</span><br><span class="line">    <span class="keyword">return</span> r</span><br></pre></td></tr></table></figure></p>
<h2 id="三、缓存中的数据"><a href="#三、缓存中的数据" class="headerlink" title="三、缓存中的数据"></a>三、缓存中的数据</h2><h3 id="1-Session"><a href="#1-Session" class="headerlink" title="1.Session"></a>1.<em>Session</em></h3><p>服务器上可以session缓存客户端所需要的数据，并通过session标识码来区分不同的客户端会话。在Flask中，通过flask.session对象来使用session，改对象也是线程独立的。<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, session</span><br><span class="line">app = Flask()</span><br><span class="line">app[<span class="string">"SECRET_KEY"</span>]=<span class="string">"123456"</span></span><br><span class="line"><span class="meta">@app.route("/view")</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">view</span><span class="params">()</span>:</span></span><br><span class="line">    session.get(<span class="string">"key"</span>, <span class="keyword">None</span>)    <span class="comment"># 获取session的value值</span></span><br><span class="line">    session[<span class="string">"key"</span>] = <span class="string">""</span>         <span class="comment"># 设置session，将会通过cookie返回session标识码。</span></span><br></pre></td></tr></table></figure></p>
<p>值得注意的是在flask中使用session需要配置SECRET_KEY。在Flask中，每次有session的写入操作，都将会重新生成新的session标识码，并通过cookie返回客户端。</p>
<h3 id="2-SimpleCache"><a href="#2-SimpleCache" class="headerlink" title="2.SimpleCache"></a>2.<em>SimpleCache</em></h3><p>这是Flask自带的一种简易缓存结构，该缓存和普通的Python字典相比，多了缓存超时清理功能，以及value序列化。</p>
<h4 id="a-基本使用"><a href="#a-基本使用" class="headerlink" title="a) 基本使用"></a>a) 基本使用</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> SimpleCache</span><br><span class="line">cache = SimpleCache(timeout=<span class="number">600</span>)    <span class="comment"># 构建缓存，默认超时时间是600秒，即5分钟。若timeout=0，则不会超时。</span></span><br><span class="line">cache.set(<span class="string">"k"</span>, <span class="string">"v"</span>)                 <span class="comment"># 设置kv对，若k已经存在，将会刷新超时时间</span></span><br><span class="line">cache.get(<span class="string">"k"</span>)                      <span class="comment"># 获取v，若k不存在，将会返回None</span></span><br></pre></td></tr></table></figure>
<h4 id="b-超时机制"><a href="#b-超时机制" class="headerlink" title="b) 超时机制"></a>b) 超时机制</h4><p>SimpleCache的超时实现机理较为简单，SimpleCache中将会维护一个Python字典，这个字典的数据类似如下结构：<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cache.set(&lt;python-key&gt;, &lt;python-value&gt;)</span><br><span class="line"><span class="comment"># ------ SimpleCache的存储结构 ------</span></span><br><span class="line">_cache = &#123;</span><br><span class="line">    &lt;python-key&gt;, : &#123;</span><br><span class="line">        <span class="string">"expires"</span> : &lt;expires&gt;                   <span class="comment"># 超时时间</span></span><br><span class="line">        <span class="string">"value"</span>   : sequence(&lt;python-value&gt;)    <span class="comment"># 将实际put的数据进行序列化</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>在每次set数据时，将会先进行一次遍历式的清理，以清除超时的数据。</li>
<li>在每次get数据时，先检查key是否超时，超时则清除并返回None，否则返回缓存值。</li>
</ul>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/lsj9383">GitHub</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、请求中的数据"><span class="toc-number">1.</span> <span class="toc-text">一、请求中的数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-GET"><span class="toc-number">1.1.</span> <span class="toc-text">1.GET</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-POST"><span class="toc-number">1.2.</span> <span class="toc-text">2.POST</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Cookie"><span class="toc-number">1.3.</span> <span class="toc-text">3.Cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-Headers"><span class="toc-number">1.4.</span> <span class="toc-text">4.Headers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-File"><span class="toc-number">1.5.</span> <span class="toc-text">5.File</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-urlencode-urldecode"><span class="toc-number">1.6.</span> <span class="toc-text">6.urlencode/urldecode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-POST的中文处理"><span class="toc-number">1.7.</span> <span class="toc-text">7.POST的中文处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-Body中的数据"><span class="toc-number">1.8.</span> <span class="toc-text">7.Body中的数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、响应中的数据"><span class="toc-number">2.</span> <span class="toc-text">二、响应中的数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-字符串"><span class="toc-number">2.1.</span> <span class="toc-text">1.字符串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-JSON"><span class="toc-number">2.2.</span> <span class="toc-text">2.JSON</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Cookie-1"><span class="toc-number">2.3.</span> <span class="toc-text">3.Cookie</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、缓存中的数据"><span class="toc-number">3.</span> <span class="toc-text">三、缓存中的数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Session"><span class="toc-number">3.1.</span> <span class="toc-text">1.Session</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-SimpleCache"><span class="toc-number">3.2.</span> <span class="toc-text">2.SimpleCache</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#a-基本使用"><span class="toc-number">3.2.1.</span> <span class="toc-text">a) 基本使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#b-超时机制"><span class="toc-number">3.2.2.</span> <span class="toc-text">b) 超时机制</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://github.com/lsj9383/2019/02/06/Flask-Basic/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://github.com/lsj9383/2019/02/06/Flask-Basic/&text=Flask Basic"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://github.com/lsj9383/2019/02/06/Flask-Basic/&title=Flask Basic"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://github.com/lsj9383/2019/02/06/Flask-Basic/&is_video=false&description=Flask Basic"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Flask Basic&body=Check out this article: http://github.com/lsj9383/2019/02/06/Flask-Basic/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://github.com/lsj9383/2019/02/06/Flask-Basic/&title=Flask Basic"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://github.com/lsj9383/2019/02/06/Flask-Basic/&title=Flask Basic"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://github.com/lsj9383/2019/02/06/Flask-Basic/&title=Flask Basic"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://github.com/lsj9383/2019/02/06/Flask-Basic/&title=Flask Basic"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://github.com/lsj9383/2019/02/06/Flask-Basic/&name=Flask Basic&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2019 Arthur Lu
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/lsj9383">GitHub</a></li>
        
      </ul>
    </nav>
  </div>
</footer><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-86660611-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->


